<odoo>
    <data>
        <!-- VERSION NUEVA FORM -->
    
        <!-- VERSION NUEVA TREE -->
        <record id="obra_programa_tree_version_nuevo" model="ir.ui.view">
        <field name="name">Version de Programa Tree</field>
        <field name="model">programa.programa_version</field>
        <field name="arch" type="xml">
            <tree string="Versiones de Programa">
              <field name="programa"/>
              <field name="tipo"/>
              <field name="fecha"/>
              <field name="comentario"/>
            </tree>
        </field>
    </record>


    <!-- VERSION DE PROGRAMA VENTANA EMERGENTE -->
    <record id="vista_form_programa" model="ir.ui.view">
        <field name="name">Programa</field>
        <field name="model">programa.programa_obra</field>
        <field name="priority">17</field>
        <field name="context">17</field>
        <field name="arch" type="xml">
            <form>

                <div class="panel panel-default">
                      <div class="panel-body">
                        <h3 colspan="2" align="center"> PARTIDA:
                            <field name="obra" readonly="1"/> </h3>
                      </div>
                  </div>

                <sheet>
                   <field name="id_prog" invisible="1"/>

                   <group colspan="1" col="4">
                      <field name="fecha_inicio_programa" string="Fecha de Inicio" readonly="1" /> <!-- attrs="{'invisible': [('fecha_inicio_convenida', '!=', False)]}" -->
                      <field name="fecha_termino_programa" string="Fecha de Termino"  readonly="1"/> <!--  attrs="{'invisible': [('fecha_termino_convenida', '!=', False)]}" -->
                      <field name="inicio_anterior" invisible="1" readonly="1"/> <!--  attrs="{'invisible': [('fecha_termino_convenida', '!=', False)]}" -->
                      <field name="termino_nueva" invisible="1" readonly="1"/> <!--  attrs="{'invisible': [('fecha_termino_convenida', '!=', False)]}" -->
                    </group>
                    <hr/>
                    <group colspan="1" col="4">
                      <field name="fecha_inicio_convenida" string="Fecha de Inicio Convenida"  /> <!-- attrs="{'invisible': [('fecha_inicio_convenida', '=', False)]}" -->
                      <field name="fecha_termino_convenida"  string="Fecha de Termino Convenida" /> <!-- attrs="{'invisible': [('fecha_termino_convenida', '=', False)]}" -->
                    </group>
                    <hr/>

                    <group colspan="1" col="6">
                      <field name="total_partida" readonly="True" widget="monetary" string="Monto Contrato/sIva"/>
                      <field name="total_programa" string="Total Programa:" force_save="1"/>
                      <field name="restante_programa" readonly="1"/>
                    </group>

                    <group col="4">
                        <field name="ultima_fecha_inicio" force_save="1" invisible="1"/>
                        <field name="ultima_fecha_termino" force_save="1" invisible="1"/>
                    </group>

                  <group>
                      <field name="programa_contratos" widget='one2many' nolabel="1" context="{
                                   'default_fecha_inicio': ultima_fecha_inicio,
                                   'default_fecha_termino': ultima_fecha_termino,
                                   'default_obra': active_id,
                                   }">
                         <tree editable="bottom" delete="false" decoration-info="mes_actual==True" decoration-bf="mes_actual == True"
                         decoration-warning="mes_restante == True" decoration-danger="mes_ultimo == True"
                         decoration-success="mes_paso == True"
                         >
                             <control>
                                <create string="Agregar Periodo" context="{
                                   'default_obra': active_id,
                                   }"/>
                             </control>
                             <field name="id_prog" invisible="1"/> <!-- de importacion -->

                             <field name="obra" force_save="1" readonly="1" />
                             <field name="fecha_inicio"/>
                             <field name="fecha_termino"/>
                             <field name="monto" sum="Total:"/>
                             <field name="porcentaje_programa" />
                             <field name="mes_actual" invisible="1"/>
                             <field name="mes_paso" invisible="1"/>
                             <field name="mes_restante" invisible="1"/>
                             <field name="mes_ultimo" invisible="1"/>
                             <button string="BORRAR" name="borrar" type="object" class="btn btn-danger"
                                        confirm="Esta seguro de borrar esta linea?" />
                         </tree>
                       </field>
                </group>
                    <!--group class="oe_edit_only">
                        <field name="tipo" widget="radio" class="oe_inline" attrs="{'invisible': [('programa_contratos', '=', [])]}"
                        force_save="1"/>
                        <field name="razon" string="ModificaciÃ³n" attrs="{'invisible': [('programa_contratos', '=', [])]}"
                        force_save="1"/>
                    </group-->

                </sheet>
            </form>
        </field>
    </record>
    
        <!-- FILTRO SEARCH DE ENLACE VERSION DE PROGRAMA -->
        <record id="programa_search" model="ir.ui.view">
           <field name="name">programa search</field>
           <field name="model">programa.programa_version</field>
            <field name="arch" type="xml">
            <search string="">
              <field name="tipo"/>
              <field name="fecha"/>
              <field name="programa"/>
              <field name="comentario"/>
            </search>
           </field>
        </record>

        <!-- PROGRAMA TREE -->
    <record id="obra_programa_tree" model="ir.ui.view">
        <field name="name">programa tree</field>
        <field name="model">programa.programa_obra</field>
        <field name="arch" type="xml">
            <tree string="" delete="false">
              <field name="obra"/>
              <field name="fecha_inicio_programa"/>
              <field name="fecha_termino_programa"/>
              <field name="total_partida" />
              <field name="restante_programa" />
            </tree>
        </field>
    </record>


        <!-- PARTIDAS TREE PROGRAMAS -->
     <record model="ir.ui.view" id="programa_tree">
      <field name="name">Programa tree</field>
      <field name="model">partidas.partidas</field>
      <field name="arch" type="xml">
        <tree create="false" default_order="obra desc">
            <field name="fechainicio"/>
            <field name="fechatermino"/>
            <field name="nombre_partida" string="Subcontrato"/>
            <field name="tipo_obra" />
            <field name="objeto"/>
            <field name="contratista" />
            <field name="residente_obra" string="Residente" widget="many2many_tags"/>
            <field name="obra" />
             <field name="monto_partida" string="Importe Contratado" />
            <field name="a_fis" />
            <field name="porcentajeProgramado" />
            <field name="a_fin" />
            <field name="verif_programa" string="(SI, NO)" widget="boolean"/>
        </tree>
      </field>
    </record>

        <!-- PARTIDAS PROGRAMA FORM -->
    <record model="ir.ui.view" id="programa_form">
      <field name="name">Programa Partida</field>
      <field name="model">partidas.partidas</field>
      <field name="arch" type="xml">
        <form create="false" edit="false" delete="false">
            <sheet>
                    <div class="text-right">
                        <button name="ProgramasVentana" class="btn btn-outline-primary btn-lg " type="object"
                             string="PROGRAMA DE LA OBRA" context="{'default_obra': active_id, 'default_obraid': id}"
                             icon="fa-clock-o"/>

                
                     </div>
                        <group>
                           <p><b>Nombre de la Obra: </b></p>
                        </group>
                        <group>
                            <field name="obra" nolabel="1" readonly="1"/>
                        </group>

                            <hr/>
                        <group colspan="2" col="5" >
                            <b>Programa</b>
                            <b>Ejercicio</b>
                            <b>Monto</b>
                            <b>Municipio</b>
                            <b>Localidad</b>
                        </group>
                        <group colspan="2" col="6" >
                            <field name="programaInversion" readonly="True" string="" nolabel="1" />
                            <field name="ejercicio" string="" nolabel="1" readonly="1" />
                            <field name="total_partida" widget="monetary" string="" nolabel="1" readonly="1"/>
                            <field name="municipio" string="" nolabel="1" readonly="1"/>
                            <field name="localidad" string="" nolabel="1" readonly="1"/>
                        </group>
                          <hr/>
                        <group colspan="2" col="5">
                            <b>Fecha del Anticipo</b>
                            <b>Fecha del contrato</b>
                            <b>Fecha de Inicio Contractual</b>
                            <b>Fecha de Termino Contractual</b>
                            <b>Supervision Externa</b>
                        </group>



                        <group colspan="2" col="6" readonly="1">
                          <field name="fecha_anticipos" readonly="1" string="" nolabel="1"/>
                          <field name="fecha" string="" nolabel="1" readonly="1"/>
                          <field name="fechainicio" string="" nolabel="1" readonly="1"/>
                          <field name="fechatermino" string="" nolabel="1" readonly="1"/>
                          <field name="supervisionexterna1" string="" nolabel="1" readonly="1"/>
                  </group>
              </sheet>
         
            </form>
          </field>
        </record>
        <!-- ACTION MENU ITEM -->
    <record model="ir.actions.act_window" id="programa_record">
          <field name="name">PROGRAMA DE OBRA</field>
          <field name="type">ir.actions.act_window</field>
          <field name="res_model">partidas.partidas</field>
          <field name="target">current</field>
          <field name="view_mode">tree</field>
         <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('programa_tree')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('programa_form')})]"/>
    </record>

        <record id="programa_import_tree" model="ir.ui.view">
            <field name="name">programa import</field>
            <field name="model">proceso.programa</field>
            <field name="arch" type="xml">
                <tree string="">
                    <field name="obra"/>
                    <field name="id_prog" invisible="1"/>
                    <field name="fecha_inicio"/>
                    <field name="fecha_termino"/>
                    <field name="monto"/>
                </tree>
            </field>
        </record>

         <!-- FILTRO SEARCH DE ENLACE VERSION DE PROGRAMA -->
        <record id="programa_informe_search" model="ir.ui.view">
           <field name="name">programa search</field>
           <field name="model">proceso.programa</field>
            <field name="arch" type="xml">
            <search string="">
            <filter name="group_obra" string="Contrato" context="{'group_by':'obra'}"/>
              <field name="obra" string="Contrato"/>
            </search>
           </field>
        </record>

        <record model="ir.ui.view" id="view_programa_graph">
           <field name="name">programa grafica</field>
           <field name="model">proceso.programa</field>
           <field name="arch" type="xml">
                 <graph string="Programa graph">
                      <field name="fecha_inicio" group="True"/>
                      <field name="fecha_termino"/>
                      <field name="monto" />
                </graph>
            </field>
        </record>

        <record id="programa_import_action" model="ir.actions.act_window">
            <field name="name">Registros de programa de obra</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">proceso.programa</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                <!-- Add Text Here -->
              </p><p>
                <!-- More details about what a user can do with this object will be OK -->
              </p>
            </field>
        </record>

        <record id="programa_parti_action" model="ir.actions.act_window">
            <field name="name">programa action view</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">programa.programa_obra</field>
            <field name="view_mode">tree</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                <!-- Add Text Here -->
              </p><p>
                <!-- More details about what a user can do with this object will be OK -->
              </p>
            </field>
        </record>

     <menuitem name="Programa de obra" id="programa_obra" parent="ejecucion_obra.menu_root"
              action="programa_record" sequence="0"/>

    <menuitem name="Informe programa de obra" id="informe_programa_obra" parent="ejecucion_obra.menu_root"
              action="programa_import_action" sequence="6"/>          



    </data>
</odoo>
